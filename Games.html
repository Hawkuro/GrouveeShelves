<!DOCTYPE html>
<html>
<head>
	<title>Games list</title>
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
	<style type="text/css" media="screen">
		body {
			margin:0;
		}
		.grouvee_container {
		/* customize grid container div here. eg: width: 500px; */
			max-width:90px;
	    }

	    .grouvee_game {
	     	/* customize game cover container div here */
	      	float: left;
	      	width: 90px;
	    	height: 90px;
	        padding: 0px 0px;
	        overflow: hidden;
	    }
	    .grouvee_box {
	    	display:flex;
	    	flex-wrap: wrap;
	    	margin:auto;
	    	justify-content: center;
	    	flex: 1;
	    }
	    .grouvee_box>div {
	    	display:flex;
	    	flex-wrap: wrap;
	    	justify-content: center;
	    	min-width:100%;
	    }
	    .grouvee_box>div>h2 {
	    	font-family: tahoma;
	    	min-width:100%;
	    	text-align: center;
	    }
	    .grouvee_box>div>h2>a{
	    	color: black;
	    }
	    .tabcontent {
		    display: flex;
		    justify-content: center;
		    max-width: 1000px;
		    margin: 10px auto;
		}
		/*Following is edited version of CSS from https://codepen.io/FelipeMartinin/pen/uFnhf*/
		#tab_bar {
			font-family: arial, sans-serif;
			border-bottom: 1px solid grey;
			width: 100%;
			overflow: hidden;
			height: 50px;
			line-height: 50px;
		    display: flex;
		    justify-content: center;
		}
		#tab_bar>.tabmenu {
			float: left;
			background: white;
			color: #777777;
			height: 45px;
			margin: 2px 15px 0;
			padding: 0 15px;
			cursor: pointer;
			text-decoration:none;
			border-bottom: 3px solid white;
		}
		#tab_bar>.tabmenu.active {
			color: #dd4b39;
			border-bottom: 3px solid #dd4b39;
		}
	</style>
	<script type="text/javascript">

		// ---- EDIT HERE ----
		// Switch the shelves and tab names for your own:
		var shelfTabs = {
			"Active": [[141977,142193,142000,141979],[141976,141978]],
			"Archived": [[141975,148530]]
		};

		var settings = {
			hideEmptyShelves: true,
			showTabBar: Object.keys(shelfTabs).length > 1
		}
		// --- IGNORE THE REST ---

		function scrub(text) {
			return text.split(' ').slice(1,-2).join(' ');
		}
		function fixlink(link){
			return "http://grouvee.com/"+link.substring(8);
		}

		function cleanup(widget, isHidden){
			widget.firstElementChild.firstElementChild.innerText = scrub(widget.firstElementChild.firstElementChild.innerText);
			widget.firstElementChild.firstElementChild.href = fixlink(widget.firstElementChild.firstElementChild.href);

			if(settings.hideEmptyShelves && widget.childElementCount == 1){
				widget.style = "display:none"
			}

			if(isHidden){
				widget.parentElement.parentElement.style = "display:none";
			}
		}

		function addChild(parent, type, className, id, href){
			var child = document.createElement(type||"div");
			if(className){
				child.className = className;
			}
			if(id){
				child.id = id;
			}
			if(href){
				child.href = href;
			}
			parent.appendChild(child);
			return child;
		}

		function generateTabPage(grouvee_box, columns, hideTab, column, row){
			column = column || 0;
			row = row || 0;

			if(column > 0 && row == 0){
				grouvee_box = addChild(grouvee_box.parentElement, "div", "grouvee_box");
			}

			var lastWidget = false;
			var nextRow = row+1 < columns[column].length ? row+1 : 0;
			var nextColumn = nextRow == 0 ? column + 1 : column;

			if(nextColumn >= columns.length){
				lastWidget = true;
			}

			var shelfid = columns[column][row];
			var widget = addChild(grouvee_box,"div",null,`grouvee_widget_${shelfid}`);

			var script = document.createElement("script");
			script.src = `https:\/\/www.grouvee.com\/widgets\/shelf\/${shelfid}\/?number=20`;
			script.type = "text/javascript";
			script.charset = "utf-8";

			script.addEventListener('load',function(){
				cleanup(widget, hideTab && lastWidget);
				if(!lastWidget){
					generateTabPage(grouvee_box,columns,hideTab,nextColumn,nextRow)
				}
			});

			grouvee_box.appendChild(script);
			return script;
		}

		var root = document.getElementsByTagName("body")[0];
		var index = 1;

		if(settings.showTabBar){
			var tabs = addChild(root,"div",null,"tab_bar");
		}

		for(var tab in shelfTabs){
			var tabId = `${tab.toLowerCase()}_games`;

			if(settings.showTabBar){
				var tabButtonId = `tb_${index}`;
				addChild(tabs,"a","tabmenu"+(index == 1?" active":""), tabButtonId, `javascript:rudrSwitchTab('${tabButtonId}', '${tabId}');`).appendChild(document.createTextNode(tab));
			}

			var tabcontent = addChild(root,"div","tabcontent",tabId);

			generateTabPage(addChild(tabcontent, "div", "grouvee_box"),shelfTabs[tab],index!=1);

			index++;
		}

		// Source for below: https://rudrastyh.com/javascript/tabs.html
		function rudrSwitchTab(rudr_tab_id, rudr_tab_content) {
			// first of all we get all tab content blocks (I think the best way to get them by class names)
			var x = document.getElementsByClassName("tabcontent");
			var i;
			for (i = 0; i < x.length; i++) {
				x[i].style.display = 'none'; // hide all tab content
			}
			document.getElementById(rudr_tab_content).style.display = 'flex'; // display the content of the tab we need
		 
			// now we get all tab menu items by class names (use the next code only if you need to highlight current tab)
			var x = document.getElementsByClassName("tabmenu");
			var i;
			for (i = 0; i < x.length; i++) {
				x[i].className = 'tabmenu'; 
			}
			document.getElementById(rudr_tab_id).className = 'tabmenu active';
		}

	</script>
</body>
</html>